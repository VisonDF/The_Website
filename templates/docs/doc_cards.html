{% extends "base.html" %}

{% block title %}
Admin panel
{% endblock %}

{% block content %}

        <!-- Hero -->
        <section class="hero">
            {% if lvl == 'high' %}
            <h1>Welcome to VisonDF High-Level API Documentation</h1>
            <select id="api-level-select" class="admin-select">
              <option value="high" selected>High-level API</option>
              <option value="low">Low-level API</option>
            </select>
            {% else %}
            <h1>Welcome to VisonDF Low-Level API Documentation</h1>
            <select id="api-level-select" class="admin-select">
              <option value="high">High-level API</option>
              <option value="low" selected>Low-level API</option>
            </select>
            {% endif %}


            {% if not family %}
                <p>Pick a function family below.</p>
            {% else %}
                <p>Pick a function below.</p>
            {% endif %}
        </section>

        <!-- Card Grid -->
        <section class="container">
            <div class="card-grid">

                {% if not family %}

                    {% for card in cards %}
                        
                        {% set variant = (loop.index0 % 4) + 1 %}
                        
                        <div class="doc-card card-variant-{{ variant }}">
                            <h3>{{ card.display_name }}</h3>
                            <p>
                            {{ card.description }}
                            </p>
                            <a class="btn" href="{{ url_for('docs.show_functions', 
                                                             lvl=lvl, 
                                                             slug=card.slug) }}">Go! →</a>
                        </div>
                    {% endfor %}

                {% else %}

                    {% for card in cards %}

                        {% set variant = (loop.index0 % 4) + 1 %}

                        <div class="doc-card card-variant-{{ variant }}">
                            <h3>{{ card.real_name }}</h3>
                            <p>
                            {{ card.description_html | safe }}
                            </p>
                            <a class="btn" href="{{ url_for('docs.function_doc', 
                                                             function_id=card.id) }}">Go! →</a>
                        </div>

                    {% endfor %}

                {% endif %}

            </div>
        </section>

        <br>

        <script>
          {% if not family %}
            document.getElementById("api-level-select")
              .addEventListener("change", (e) => {
                const level = e.target.value;
                if (!level) return;
        
                // Redirect to your docs route
                window.location.href = `/docs/${level}`;
              });
          {% else %}
            const family = "{{ family }}"
            document.getElementById("api-level-select")
              .addEventListener("change", (e) => {
                const level = e.target.value;
                if (!level) return;
        
                // Redirect to your docs route
                  window.location.href = `/docs/${level}+${ family }`;
              });
          {% endif %}
        </script>

{% endblock %}





